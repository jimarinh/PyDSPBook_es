<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
    <title>Muestreo de Señales</title>
    <script type="text/javascript">
		var yscale = 1;
		var xscale = 10;
        function showAxes(ctx,axes) {
            var width = ctx.canvas.width;
            var height = ctx.canvas.height;
            var xMin = 0;
            
            ctx.beginPath();
            ctx.strokeStyle = "rgb(128,128,128)";
            
            // X-Axis
            ctx.moveTo(xMin, height/2);
            ctx.lineTo(width, height/2);
            
            ctx.stroke();
        }
		
		function drawSample(ctx, n, xn) {            
            var x = n*xscale;
			var y = ctx.canvas.height/2 - xn*yscale;
			var radius = 2;
            ctx.beginPath();
			ctx.arc(x, y, radius, 0, 2 * Math.PI, false);
            ctx.fillStyle = 'red';
            ctx.fill();
            ctx.lineWidth = 1;
            ctx.stroke();
			ctx.strokeStyle = "rgb(128,128,128)";
            ctx.moveTo(x, ctx.canvas.height/2);
            ctx.lineTo(x, y);
			ctx.stroke();
        }
		
		function drawDot(ctx, n, xn) {            
            var x = n*xscale;
			var y = ctx.canvas.height/2 - xn*yscale;
			var radius = 2;
            ctx.beginPath();
			ctx.arc(x, y, radius, 0, 2 * Math.PI, false);
            ctx.fillStyle = 'red';
            ctx.fill();
            ctx.lineWidth = 1;
            ctx.stroke();
        }
		
		function quantize(xn) {
			if (qcheck.checked) {
				var nsteps = 1 << (qbits.value-1);
				return Math.floor(xn * nsteps) / nsteps;
			} else {
				return xn;
			}
		}
		
		function PlotSampling() {            
            var canvas1 = document.getElementById("canvas1");
            var context = canvas1.getContext("2d");
            
			context.clearRect(0, 0, context.canvas.width, context.canvas.height);
            showAxes(context);
			//context.save();
		
			var w0 = 2*Math.PI*f0.value;
			var phasev = phase.value*Math.PI/180;
			var tmax = f0.value>0 ? Ncycles.value*(1.0/f0.value) : 1;
			var fsv = fs.value;
			
			//Plot continuous signal
			var n;
			xscale = tmax/context.canvas.width;
			yscale = 0.9*context.canvas.height/2;
			
			context.beginPath();
			context.strokeStyle = "rgb(0,0,255)";
			context.moveTo(0, (1-Math.sin(phasev))*yscale);
			
			for(n=1; n<context.canvas.width; n++) {
				context.lineTo(n, context.canvas.height/2 - Math.sin(w0*n*xscale + phasev)*yscale);
			}
			context.stroke();
			
			//Plot Sampling
			var Ts = 1.0/fs.value;
			var Nmax = tmax/Ts;
			switch(plotstyle.options[plotstyle.selectedIndex].value) {
				case "deltas": //Deltas
					xscale = Ts*context.canvas.width/tmax;
					for (n=0; n<=Nmax; n++) {
						drawSample(context, n, quantize(Math.sin(w0*n*Ts + phasev)));
					}
					break;
					
				case "lines": //lines
					xscale = Ts*context.canvas.width/tmax;
					for (n=0; n<=Nmax; n++) {
						drawDot(context, n, quantize(Math.sin(w0*n*Ts + phasev)));
					}
					context.beginPath();
					context.strokeStyle = "rgb(255,0,0)";
					context.moveTo(0, context.canvas.height/2 - quantize(Math.sin(phasev))*yscale);			
					for(n=1; n<=Nmax; n++) {
						context.lineTo(n*xscale, context.canvas.height/2 - quantize(Math.sin(w0*n*Ts + phasev))*yscale);
					}
					context.stroke();
					break;
					
				case "scales": //scales
					var xp, yp;
					xscale = Ts*context.canvas.width/tmax;
					context.beginPath();
					context.strokeStyle = "rgb(255,0,0)";
					xp = 0;
					yp = context.canvas.height/2 - quantize(Math.sin(phasev))*yscale;
					context.moveTo(xp, yp);			
					for(n=1; n<=Nmax; n++) {
						yp = context.canvas.height/2 - quantize(Math.sin(w0*n*Ts + phasev))*yscale;
						context.lineTo(xp, yp);
						xp = n*xscale;
						context.lineTo(xp, yp);
					}
					context.stroke();
					break;
			}
        }
        function redraw() {
			PlotSampling();
		}
        function init() {
            redraw();
        }
    </script>
</head>

<body onload="init()">
<h1>Muestreo de señales</h1>

  <b>Señal senoidal</b>: 
  Frecuencia (Hz) <input type="number" id="f0" min="0" max="100000" step="100" value="1000" onchange="redraw()"> 
  Fase (grados)  <input type="number" id="phase" min="0" max="90" step="10" value="0" onchange="redraw()">
  Número de ciclos <input type="number" id="Ncycles" min="1" max="30" value="10" onchange="redraw()">
  <br><br>
  <b>Frecuencia de muestreo</b>: <input type="number" id="fs" min="1" max="100000" value="10000" step="100" onchange="redraw()"> 
  &nbsp; 
  <input type="checkbox" id="qcheck" onchange="redraw()">
  Cuantizar a: 
  <input type="number" id="qbits" min="2" max="24" step="1" value="8" onchange="redraw()">   
  <br><br>
  <b>Estilo de la gráfica del muestreo</b>: 
  <select id="plotstyle" onchange="redraw()">
    <option value="deltas" selected>Deltas</option>
	<option value="lines">Líneas</option>
	<option value="scales">Escalones</option>
  </select>
  <br><br>
  <canvas id="canvas1" width="500" height="100"></canvas>
</body>

</html>